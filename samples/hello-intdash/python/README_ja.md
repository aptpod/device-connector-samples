Hello intdash! (Python)
=======================

このフォルダーは、intdashサーバーにデータを送信するデバイスコネクターのサンプルです。

このデバイスコネクターはPythonで作成されており、一定の文字列を一定の間隔でAgentに渡します。

本来は、センサーなどのデバイスから取得したデータをAgentに渡すのがデバイスコネクターの役割ですが、ここではその代わりにプログラム内で文字列データ（"Hello intdash!"）を発生させ、Agentに渡します。
Agentは、受け取ったデータをintdashサーバーに送信します。

## 前提条件

### 実行環境
- intdash Edge 1.15.0 以降
- Python3

## 使用手順

1. Agent用の設定ファイル（manager.conf）に、接続先サーバーとエッジ（Agent自身）の情報を書き込みます。

    以下の情報を設定します。設定が必要な個所がそれぞれ2箇所あることに注意してください。
    
    - `"host"` : 接続先サーバー、2箇所（例：dummy.intdash.jp）
    - `"my_id"` : エッジ（Agent自身）のUUID、２箇所（例：01234567-0123-0123-0123-0123456789AB）
    - `"my_token"` : エッジトークン、2箇所（例：0123456789ABCDEFGHIJ0123456789abcdefghij01234567）

2. Agent用の設定ファイル（manager.conf）で、使用するデバイスコネクターのパスを指定します。設定する箇所は以下のとおりです。

    - loggersオブジェクトの `"path"`: このサンプルフォルダーにあるcustomized-logger.pyのフルパス

3. デバイスコネクターのファイルを実行可能にします。

    以下のコマンドで、デバイスコネクターのファイルに実行のパーミッションを設定してください。<サンプルフォルダーのフルパス> には適切なパスを設定してください。

    ```
    $ chmod 755 <サンプルフォルダーのフルパス>/customized-logger.py
    ````

4. intdash Edgeを実行します。

    以下のコマンドで、intdash Edgeを起動します。その際、設定ファイルとして、上の手順で変更したmanager.confを指定します。
	<サンプルフォルダーのフルパス> には適切なパスを設定ししてください。

    ```
    $ sudo LD_LIBRARY_PATH=/opt/vm2m/lib /opt/vm2m/sbin/intdash-edge-manager -C <サンプルフォルダのフルパス>/manager.conf
    ```

## 実行結果

intdashサーバーに以下のデータポイントが送信されます。
約500[msec]ごとに1つのデータポイントが送信され、20回送信されると終了します。

| 送信データのフィールド　| 値                   |
|:-------------------|:-----------------------|
| 送信元エッジ         | `"my_id"`に設定したエッジ |
| チャンネル           | 100                    |
| データタイプ         | String (0x0a)          |
| データID            | abc                    |
| データ              | Hello intdash!         |


### その他

標準出力にはさまざまなログが出力されます。通信に関する主要なログは以下のとおりです。

| ログ                                                 | 意味                                                                              |
|:----------------------------------------------------|:----------------------------------------------------------------------------------|
| `REALTIME 15 units and 0 basetimes with ID:10`      | intdash Edgeがサーバーにリアルタイムで送信できた秒間データ数（この例の場合、データポイントのユニットが15個、基準時刻が0個）です。                          |
